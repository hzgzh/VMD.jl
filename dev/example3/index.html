<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>exmaple3 · VMD.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">VMD.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/">example</a></li><li><a class="tocitem" href="../example1/">example1</a></li><li><a class="tocitem" href="../example2/">example2</a></li><li class="is-active"><a class="tocitem" href>exmaple3</a><ul class="internal"><li><a class="tocitem" href="#plot-the-original-signal-and-spectrum-1"><span>plot the original signal and spectrum</span></a></li><li><a class="tocitem" href="#plot-the-1st-decomposed-signal-and-spectrum-1"><span>plot the 1st decomposed signal and spectrum</span></a></li><li><a class="tocitem" href="#plot-the-2st-signal-and-spectrum-1"><span>plot the 2st signal and spectrum</span></a></li><li><a class="tocitem" href="#plot-the-3st-decomposed-signal-and-spectrum-1"><span>plot the 3st decomposed signal and spectrum</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../api/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>exmaple3</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>exmaple3</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/hzgzh/VMD.jl/blob/master/docs/src/example3.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="Example-3-1"><a class="docs-heading-anchor" href="#Example-3-1">Example 3</a><a class="docs-heading-anchor-permalink" href="#Example-3-1" title="Permalink"></a></h3><p>The third synthetic signal has intrawave fre- quency modulation:</p>$<p>f_{\mathrm{Sig} 3}(t)=\frac{1}{1.2+\cos (2 \pi t)}+\frac{\cos (32 \pi t+0.2 \cos (64 \pi t))}{1.5+\sin (2 \pi t)} $</p><p>The signal, its three constituent modes, and the composite Fourier spectrum are shown in Fig. 11. While the first, bell-shaped component has mostly low-pass content, the second mode’s main peak is clearly identified at <span>$32\pi$</span> . However, due to the non-linear intrawave frequency modulation, an important amount of higher-order harmonics are also observed. This second component obviously violates the narrow-band assumption, and one would naturally expect some difficulties recovering this mode using VMD.</p><p>The corresponding VMD results are illustrated in Fig. 11. The non-zero <span>$\omega_2$</span> quickly converges to the correct main frequency <span>$32\pi$</span> . The higher order harmonics are not uniquely attributed to the second mode, however, but shared between both modes. Consequently, the intrawave frequency modulation is shared by both modes, creating some ripples in the otherwise low-fre- quency mode.</p><pre><code class="language-julia-repl">julia&gt; using VMD,Random,Plots

julia&gt; T = 1000;

julia&gt; t = (1:T)/T;

julia&gt; sample_frequency = 1000;

julia&gt; # modes
       v_1 = @. 1.0/(1.2+cos(2π*t))
1000-element Array{Float64,1}:
 0.4545495329175559
 0.45456176831196904
 0.4545821615630583
 0.4546107140615579
 0.4546474277547602
 0.454692305146782
 0.45474534929890503
 0.4548065638299934
 0.4548759529169864
 0.45495352129546823
 ⋮
 0.4548065638299934
 0.45474534929890503
 0.454692305146782
 0.4546474277547602
 0.4546107140615579
 0.4545821615630583
 0.45456176831196904
 0.4545495329175559
 0.45454545454545453

julia&gt; v_2 = @. cos(32π*t+0.2cos(64π*t))
1000-element Array{Float64,1}:
 0.9563643791457606
 0.9267577544454604
 0.8932381241846964
 0.857269028355134
 0.8197510155751393
 0.7810391828255306
 0.7409958433212279
 0.6990632628481571
 0.6543460010702756
 0.6056977932415857
 ⋮
 0.6882039341995528
 0.7830825598010769
 0.8618432690171852
 0.9228081034437001
 0.9655120910629869
 0.9906456805109204
 0.9998552388456428
 0.9954490548970377
 0.9800665778412418

julia&gt; v_3 = @. 1.5+sin(2π*t)
1000-element Array{Float64,1}:
 1.5062831439655588
 1.5125660398833527
 1.5188484397154083
 1.5251300954433376
 1.5314107590781283
 1.5376901826699345
 1.5439681183178648
 1.5502443181797696
 1.5565185344820245
 1.5627905195293135
 ⋮
 1.4497556818202297
 1.456031881682135
 1.4623098173300648
 1.4685892409218717
 1.474869904556662
 1.481151560284592
 1.487433960116647
 1.4937168560344412
 1.4999999999999998

julia&gt; # composite signal, including noise
       f = v_1 + v_2./v_3 + 0.1*randn(length(v_1));

julia&gt; # some sample parameters for VMD
       alpha = 2000;       # moderate bandwidth constraint

julia&gt; tau = 0;            # noise-tolerance (no strict fidelity enforcement)

julia&gt; K = 4;              # 3 modes

julia&gt; DC = false;             # no DC part imposed

julia&gt; init = 0;           # initialize omegas uniformly

julia&gt; tol = 1e-7;

julia&gt; v = vmd(f ; alpha = alpha,tau = tau,K = K,DC = false,init = init,tol = tol,sample_frequency = sample_frequency)
--iteration times 500 -- error 0.0006650980088188975

julia&gt; # the first mode frequency
       print(&quot;1st mode frequency $(n_mode(v,1))&quot;)
1st mode frequency 0.13897967734293806
julia&gt; p0 = VMD.plot(v,k=0)
Plot{Plots.GRBackend() n=2}

julia&gt; savefig(p0,&quot;3_0.png&quot;)

julia&gt; p1 = VMD.plot(v,k=1)
Plot{Plots.GRBackend() n=2}

julia&gt; savefig(p1,&quot;3_1.png&quot;)

julia&gt; p2 = VMD.plot(v,k=2)
Plot{Plots.GRBackend() n=2}

julia&gt; savefig(p2,&quot;3_2.png&quot;)

julia&gt; p3 = VMD.plot(v,k=3)
Plot{Plots.GRBackend() n=2}

julia&gt; savefig(p3,&quot;3_3.png&quot;)</code></pre><h2 id="plot-the-original-signal-and-spectrum-1"><a class="docs-heading-anchor" href="#plot-the-original-signal-and-spectrum-1">plot the original signal and spectrum</a><a class="docs-heading-anchor-permalink" href="#plot-the-original-signal-and-spectrum-1" title="Permalink"></a></h2><p><img src="../3_0.png" alt/></p><h2 id="plot-the-1st-decomposed-signal-and-spectrum-1"><a class="docs-heading-anchor" href="#plot-the-1st-decomposed-signal-and-spectrum-1">plot the 1st decomposed signal and spectrum</a><a class="docs-heading-anchor-permalink" href="#plot-the-1st-decomposed-signal-and-spectrum-1" title="Permalink"></a></h2><p><img src="../3_1.png" alt/></p><h2 id="plot-the-2st-signal-and-spectrum-1"><a class="docs-heading-anchor" href="#plot-the-2st-signal-and-spectrum-1">plot the 2st signal and spectrum</a><a class="docs-heading-anchor-permalink" href="#plot-the-2st-signal-and-spectrum-1" title="Permalink"></a></h2><p><img src="../3_2.png" alt/></p><h2 id="plot-the-3st-decomposed-signal-and-spectrum-1"><a class="docs-heading-anchor" href="#plot-the-3st-decomposed-signal-and-spectrum-1">plot the 3st decomposed signal and spectrum</a><a class="docs-heading-anchor-permalink" href="#plot-the-3st-decomposed-signal-and-spectrum-1" title="Permalink"></a></h2><p><img src="../3_3.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example2/">« example2</a><a class="docs-footer-nextpage" href="../api/">Reference »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 16 June 2020 10:47">Tuesday 16 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
